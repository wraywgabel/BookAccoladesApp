Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
#Reformat book list dataframe for merge with awards dataframe
BookList2<-BookList1%>%
pivot_longer(cols=c(CriticsList, ReadersList),
names_to="ListType",
values_to="HasList")%>%
filter(HasList=="Yes")%>%
mutate(Accolade=case_when(
ListType=="CriticsList" ~ "NYT Critic's Best Books of the 21st Century",
ListType=="ReadersList" ~ "NYT Reader's Best Books of the 21st Century",
TRUE ~ NA_character_))%>%
select(-ListType, -HasList, -Read, -Rating, -NumberRatings)
#Add missing columns
BookList2$Result<-"Listed"
BookList2$Year<-""
BookList2$Category<-""
BookList2$Genres<-""
#Bind
Awards_Lists<-rbind(Awards1, BookList2, by=c("Title", "Author"))
#Bind
Awards_Lists<-rbind(Awards1, BookList2)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
View(BookClub)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
BookClub$Result<-"Listed"
BookClub$Category<-""
colnames(BookClub)
colnames(Awards_Lists)
#Remove date column
BookClub<-BookClub%>%select(-c(Date))
#Bind
Awards_Lists_Clubs<-rbind(Awards_Lists, BookClub)
View(Awards_Lists_Clubs)
#Clean up
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="Not awarded"|Author!="")
#Clean up
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="Not awarded")
Awards<-read.csv("Import/BookAwards.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Reformat
Awards1<-Awards%>%
mutate(Result=ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&Year=="", "Finalist",
ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&!is.na(Year), "Winner", Result)))%>%
mutate(cond=replace_na(Accolade=="Pulitzer"&Category=="Fiction"&Year=="", FALSE),
temp_split=if_else(cond, Author, NA_character_))%>%
separate(temp_split, into = c("Author_new", "Title_new"),
sep=",", extra="merge", fill="right")%>%
mutate(Author_new=str_trim(Author_new),
Title_new=str_trim(Title_new),
Author=coalesce(Author_new, Author),
Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
#Reformat book list dataframe for merge with awards dataframe
BookList2<-BookList1%>%
pivot_longer(cols=c(CriticsList, ReadersList),
names_to="ListType",
values_to="HasList")%>%
filter(HasList=="Yes")%>%
mutate(Accolade=case_when(
ListType=="CriticsList" ~ "NYT Critic's Best Books of the 21st Century",
ListType=="ReadersList" ~ "NYT Reader's Best Books of the 21st Century",
TRUE ~ NA_character_))%>%
select(-ListType, -HasList, -Read, -Rating, -NumberRatings)
#Add missing columns
BookList2$Result<-"Listed"
BookList2$Year<-""
BookList2$Category<-""
BookList2$Genres<-""
#Bind
Awards_Lists<-rbind(Awards1, BookList2)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Add missing columns
BookClub$Result<-"Listed"
BookClub$Category<-""
#Remove date column
BookClub<-BookClub%>%select(-c(Date))
#Bind
Awards_Lists_Clubs<-rbind(Awards_Lists, BookClub)
#Clean up
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="Not awarded")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="")
Awards<-read.csv("Import/BookAwards.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Reformat
Awards1<-Awards%>%
mutate(Result=ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&Year=="", "Finalist",
ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&!is.na(Year), "Winner", Result)))%>%
mutate(cond=replace_na(Accolade=="Pulitzer"&Category=="Fiction"&Year=="", FALSE),
temp_split=if_else(cond, Author, NA_character_))%>%
separate(temp_split, into = c("Author_new", "Title_new"),
sep=",", extra="merge", fill="right")%>%
mutate(Author_new=str_trim(Author_new),
Title_new=str_trim(Title_new),
Author=coalesce(Author_new, Author),
Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
#Reformat book list dataframe for merge with awards dataframe
BookList2<-BookList1%>%
pivot_longer(cols=c(CriticsList, ReadersList),
names_to="ListType",
values_to="HasList")%>%
filter(HasList=="Yes")%>%
mutate(Accolade=case_when(
ListType=="CriticsList" ~ "NYT Critic's Best Books of the 21st Century",
ListType=="ReadersList" ~ "NYT Reader's Best Books of the 21st Century",
TRUE ~ NA_character_))%>%
select(-ListType, -HasList, -Read, -Rating, -NumberRatings)
#Add missing columns
BookList2$Result<-"Listed"
BookList2$Year<-""
BookList2$Category<-""
BookList2$Genres<-""
#Bind
Awards_Lists<-rbind(Awards1, BookList2)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Add missing columns
BookClub$Result<-"Listed"
BookClub$Category<-""
#Remove date column
BookClub<-BookClub%>%select(-c(Date))
#Bind
Awards_Lists_Clubs<-rbind(Awards_Lists, BookClub)
#Clean up
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="Not awarded")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="")
Awards<-read.csv("Import/BookAwards.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Reformat
Awards1<-Awards%>%
mutate(Result=ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&Year=="", "Finalist",
ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&!is.na(Year), "Winner", Result)))%>%
mutate(cond=replace_na(Accolade=="Pulitzer"&Category=="Fiction"&Year=="", FALSE),
temp_split=if_else(cond, Author, NA_character_))%>%
separate(temp_split, into = c("Author_new", "Title_new"),
sep=",", extra="merge", fill="right")%>%
mutate(Author_new=str_trim(Author_new),
Title_new=str_trim(Title_new),
Author=coalesce(Author_new, Author),
Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
#Reformat book list dataframe for merge with awards dataframe
BookList2<-BookList1%>%
pivot_longer(cols=c(CriticsList, ReadersList),
names_to="ListType",
values_to="HasList")%>%
filter(HasList=="Yes")%>%
mutate(Accolade=case_when(
ListType=="CriticsList" ~ "NYT Critic's Best Books of the 21st Century",
ListType=="ReadersList" ~ "NYT Reader's Best Books of the 21st Century",
TRUE ~ NA_character_))%>%
select(-ListType, -HasList, -Read, -Rating, -NumberRatings)
#Add missing columns
BookList2$Result<-"Listed"
BookList2$Year<-""
BookList2$Category<-""
BookList2$Genres<-""
#Bind
Awards_Lists<-rbind(Awards1, BookList2)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Add missing columns
BookClub$Result<-"Listed"
BookClub$Category<-""
#Remove date column
BookClub<-BookClub%>%select(-c(Date))
#Bind
Awards_Lists_Clubs<-rbind(Awards_Lists, BookClub)
#Clean up
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="Not awarded")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="")
Awards<-read.csv("Import/BookAwards.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Reformat
Awards1<-Awards%>%
mutate(Result=ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&Year=="", "Finalist",
ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&!is.na(Year), "Winner", Result)))%>%
mutate(cond=replace_na(Accolade=="Pulitzer"&Category=="Fiction"&Year=="", FALSE),
temp_split=if_else(cond, Author, NA_character_))%>%
separate(temp_split, into = c("Author_new", "Title_new"),
sep=",", extra="merge", fill="right")%>%
mutate(Author_new=str_trim(Author_new),
Title_new=str_trim(Title_new),
Author=coalesce(Author_new, Author),
Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
#Reformat book list dataframe for merge with awards dataframe
BookList2<-BookList1%>%
pivot_longer(cols=c(CriticsList, ReadersList),
names_to="ListType",
values_to="HasList")%>%
filter(HasList=="Yes")%>%
mutate(Accolade=case_when(
ListType=="CriticsList" ~ "NYT Critic's Best Books of the 21st Century",
ListType=="ReadersList" ~ "NYT Reader's Best Books of the 21st Century",
TRUE ~ NA_character_))%>%
select(-ListType, -HasList, -Read, -Rating, -NumberRatings)
#Add missing columns
BookList2$Result<-"Listed"
BookList2$Year<-""
BookList2$Category<-""
BookList2$Genres<-""
#Bind
Awards_Lists<-rbind(Awards1, BookList2)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Add missing columns
BookClub$Result<-"Listed"
BookClub$Category<-""
#Remove date column
BookClub<-BookClub%>%select(-c(Date))
#Bind
Awards_Lists_Clubs<-rbind(Awards_Lists, BookClub)
#Clean up
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="Not awarded")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="")
#Export
write.csv(Awards_Lists_Clubs, "Export/Awards_Lists_Clubs.csv", row.names=F)
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%select(-c(Genres))
#Export
write.csv(Awards_Lists_Clubs, "Export/Awards_Lists_Clubs.csv", row.names=F)
#Export
write.csv(Awards_Lists_Clubs, "Export/Awards_Lists_Clubs.csv", row.names=F)
colnames(Awards_Lists_Clubs)
Awards<-read.csv("Import/BookAwards.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Reformat
Awards1<-Awards%>%
mutate(Result=ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&Year=="", "Finalist",
ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&!is.na(Year), "Winner", Result)))%>%
mutate(cond=replace_na(Accolade=="Pulitzer"&Category=="Fiction"&Year=="", FALSE),
temp_split=if_else(cond, Author, NA_character_))%>%
separate(temp_split, into = c("Author_new", "Title_new"),
sep=",", extra="merge", fill="right")%>%
mutate(Author_new=str_trim(Author_new),
Title_new=str_trim(Title_new),
Author=coalesce(Author_new, Author),
Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
#Reformat book list dataframe for merge with awards dataframe
BookList2<-BookList1%>%
pivot_longer(cols=c(CriticsList, ReadersList),
names_to="ListType",
values_to="HasList")%>%
filter(HasList=="Yes")%>%
mutate(Accolade=case_when(
ListType=="CriticsList" ~ "NYT Critic's Best Books of the 21st Century",
ListType=="ReadersList" ~ "NYT Reader's Best Books of the 21st Century",
TRUE ~ NA_character_))%>%
select(-ListType, -HasList, -Read, -Rating, -NumberRatings)
#Add missing columns
BookList2$Result<-"Listed"
BookList2$Year<-""
BookList2$Category<-""
BookList2$Genres<-""
#Bind
Awards_Lists<-rbind(Awards1, BookList2)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Add missing columns
BookClub$Result<-"Listed"
BookClub$Category<-""
#Remove date column
BookClub<-BookClub%>%select(-c(Date))
#Bind
Awards_Lists_Clubs<-rbind(Awards_Lists, BookClub)
#Clean up
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="Not awarded")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%select(-c(Genres))
#Export
write.csv(Awards_Lists_Clubs, "Export/Awards_Lists_Clubs.csv", row.names=F)
Awards_Lists_Clubs$average_rating<-""
Awards_Lists_Clubs$num_ratings<-""
#Export
write.csv(Awards_Lists_Clubs, "Export/Awards_Lists_Clubs.csv", row.names=F)
colnames(Awards_Lists_Clubs)
nrows(Awards_Lists_Clubs)
nrow(Awards_Lists_Clubs)
View(BookList1)
Awards<-read.csv("Import/BookAwards.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Reformat
Awards1<-Awards%>%
mutate(Result=ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&Year=="", "Finalist",
ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&!is.na(Year), "Winner", Result)))%>%
mutate(cond=replace_na(Accolade=="Pulitzer"&Category=="Fiction"&Year=="", FALSE),
temp_split=if_else(cond, Author, NA_character_))%>%
separate(temp_split, into = c("Author_new", "Title_new"),
sep=",", extra="merge", fill="right")%>%
mutate(Author_new=str_trim(Author_new),
Title_new=str_trim(Title_new),
Author=coalesce(Author_new, Author),
Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
#Reformat book list dataframe for merge with awards dataframe
BookList2<-BookList1%>%
pivot_longer(cols=c(CriticsList, ReadersList),
names_to="ListType",
values_to="HasList")%>%
filter(HasList=="Yes")%>%
mutate(Accolade=case_when(
ListType=="CriticsList" ~ "NYT Critic's Best Books of the 21st Century",
ListType=="ReadersList" ~ "NYT Reader's Best Books of the 21st Century",
TRUE ~ NA_character_))%>%
select(-ListType, -HasList, -Read, -Rating, -NumberRatings)
#Add missing columns
BookList2$Result<-"Listed"
BookList2$Year<-""
BookList2$Category<-""
BookList2$Genres<-""
#Bind
Awards_Lists<-rbind(Awards1, BookList2)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Add missing columns
BookClub$Result<-"Listed"
BookClub$Category<-""
#Remove date column
BookClub<-BookClub%>%select(-c(Date))
#Bind
Awards_Lists_Clubs<-rbind(Awards_Lists, BookClub)
#Clean up
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="Not awarded")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%select(-c(Genres))
Awards_Lists_Clubs$average_rating<-""
Awards_Lists_Clubs$num_ratings<-""
#Export
write.csv(Awards_Lists_Clubs, "Export/Awards_Lists_Clubs.csv", row.names=F)
Awards<-read.csv("Import/BookAwards.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Reformat
Awards1<-Awards%>%
mutate(Result=ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&Year=="", "Finalist",
ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&!is.na(Year), "Winner", Result)))%>%
mutate(cond=replace_na(Accolade=="Pulitzer"&Category=="Fiction"&Year=="", FALSE),
temp_split=if_else(cond, Author, NA_character_))%>%
separate(temp_split, into = c("Author_new", "Title_new"),
sep=",", extra="merge", fill="right")%>%
mutate(Author_new=str_trim(Author_new),
Title_new=str_trim(Title_new),
Author=coalesce(Author_new, Author),
Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
#####LIST 2: Reformatting list of awards for app####
#Import awards file
Awards<-read.csv("Import/BookAwards.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
Awards1<-Awards%>%
mutate(Result=ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&Year=="", "Finalist",
ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&!is.na(Year), "Winner", Result)))%>%
mutate(cond=replace_na(Accolade=="Pulitzer"&Category=="Fiction"&Year=="", FALSE),
temp_split=if_else(cond, Author, NA_character_))%>%
separate(temp_split, into = c("Author_new", "Title_new"),
sep=",", extra="merge", fill="right")%>%
mutate(Author_new=str_trim(Author_new),
Title_new=str_trim(Title_new),
Author=coalesce(Author_new, Author),
Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
View(Awards)
Awards1<-Awards%>%
mutate(Year=as.character(Year))%>%
mutate(Result=ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&Year=="", "Finalist",
ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&!is.na(Year), "Winner", Result)))%>%
mutate(cond=replace_na(Accolade=="Pulitzer"&Category=="Fiction"&Year=="", FALSE),
temp_split=if_else(cond, Author, NA_character_))%>%
separate(temp_split, into = c("Author_new", "Title_new"),
sep=",", extra="merge", fill="right")%>%
mutate(Author_new=str_trim(Author_new),
Title_new=str_trim(Title_new),
Author=coalesce(Author_new, Author),
Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
BookList2<-BookList1%>%
pivot_longer(cols=c(CriticsList, ReadersList),
names_to="ListType",
values_to="HasList")%>%
filter(HasList=="Yes")%>%
mutate(Accolade=case_when(
ListType=="CriticsList" ~ "NYT Critic's Best Books of the 21st Century",
ListType=="ReadersList" ~ "NYT Reader's Best Books of the 21st Century",
TRUE ~ NA_character_))%>%
select(-ListType, -HasList, -Read, -Rating, -NumberRatings)
#Add missing columns
BookList2$Result<-"Listed"
BookList2$Year<-""
BookList2$Category<-""
BookList2$Genres<-""
#Bind
Awards_Lists<-rbind(Awards1, BookList2)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Add missing columns
BookClub$Result<-"Listed"
BookClub$Category<-""
#Remove date column
BookClub<-BookClub%>%select(-c(Date))
#Bind
Awards_Lists_Clubs<-rbind(Awards_Lists, BookClub)
#Clean up
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="Not awarded")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%select(-c(Genres))
Awards_Lists_Clubs$average_rating<-""
Awards_Lists_Clubs$num_ratings<-""
#Export
write.csv(Awards_Lists_Clubs, "Export/Awards_Lists_Clubs.csv", row.names=F)
Awards<-read.csv("Import/BookAwards.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Reformat
Awards1<-Awards%>%
mutate(Year=as.character(Year))%>%
mutate(Result=ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&Year=="", "Finalist",
ifelse(Accolade=="Pulitzer"&Category=="General Nonfiction"&!is.na(Year), "Winner", Result)))%>%
mutate(cond=replace_na(Accolade=="Pulitzer"&Category=="Fiction"&Year=="", FALSE),
temp_split=if_else(cond, Author, NA_character_))%>%
separate(temp_split, into = c("Author_new", "Title_new"),
sep=",", extra="merge", fill="right")%>%
mutate(Author_new=str_trim(Author_new),
Title_new=str_trim(Title_new),
Author=coalesce(Author_new, Author),
Title=coalesce(Title_new, Title))%>%
select(-cond, -Author_new, -Title_new)%>%
mutate(Year=if_else(Year=="",NA_character_, Year))%>%
fill(Year, .direction="down")%>%
mutate(Result=if_else(Accolade!="Nobel"&Result=="",NA_character_, Result))%>%
fill(Result, .direction="down")%>%
ungroup()
#Reformat book list dataframe for merge with awards dataframe
BookList2<-BookList1%>%
pivot_longer(cols=c(CriticsList, ReadersList),
names_to="ListType",
values_to="HasList")%>%
filter(HasList=="Yes")%>%
mutate(Accolade=case_when(
ListType=="CriticsList" ~ "NYT Critic's Best Books of the 21st Century",
ListType=="ReadersList" ~ "NYT Reader's Best Books of the 21st Century",
TRUE ~ NA_character_))%>%
select(-ListType, -HasList, -Read, -Rating, -NumberRatings)
#Add missing columns
BookList2$Result<-"Listed"
BookList2$Year<-""
BookList2$Category<-""
BookList2$Genres<-""
#Bind
Awards_Lists<-rbind(Awards1, BookList2)
#Import book club file
BookClub<-read.csv("Import/BookClubs.csv", fileEncoding="latin1", stringsAsFactors=FALSE)
#Add missing columns
BookClub$Result<-"Listed"
BookClub$Category<-""
#Remove date column
BookClub<-BookClub%>%select(-c(Date))
#Bind
Awards_Lists_Clubs<-rbind(Awards_Lists, BookClub)
#Clean up
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="Not awarded")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%filter(Author!="")
Awards_Lists_Clubs<-Awards_Lists_Clubs%>%select(-c(Genres))
Awards_Lists_Clubs$average_rating<-""
Awards_Lists_Clubs$num_ratings<-""
#Export
write.csv(Awards_Lists_Clubs, "Export/Awards_Lists_Clubs.csv", row.names=F)
